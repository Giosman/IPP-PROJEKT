#include <Wire.h>
#include <Adafruit_Sensor.h>
#include <Adafruit_ADXL345_U.h>

Adafruit_ADXL345_Unified accel = Adafruit_ADXL345_Unified();

// Umbral de tolerancia para la comparación de valores
const float UMBRAL_TOLERANCIA = 0.5; // Ajusta este valor según la precisión deseada

void setup() {
  Serial.begin(9600);

  if (!accel.begin()) {
    Serial.println("No se pudo encontrar el sensor ADXL345.");
    Serial.println("ERROR_SENSOR"); // Informar a App Inventor
    while (1) delay(100);
  }

  accel.setRange(ADXL345_RANGE_4_G);
  Serial.println("ADXL345 configurado.");
  Serial.println("SISTEMA_LISTO"); // Mensaje inicial para App Inventor
}

void loop() {
  sensors_event_t event;
  accel.getEvent(&event);

  float accX = event.acceleration.x;
  float accY = event.acceleration.y;
  float accZ = event.acceleration.z;

  // Comprobar si los valores están dentro del umbral de los objetivos
  if (abs(accX - 0.50) < UMBRAL_TOLERANCIA &&
      abs(accY - (-0.50)) < UMBRAL_TOLERANCIA &&
      abs(accZ - (-9.60)) < UMBRAL_TOLERANCIA) {
    Serial.println("ALERTA"); // Enviar mensaje específico
  } 
  else 
  {
    Serial.println("NORMAL");
  }

  delay(2000);
}
